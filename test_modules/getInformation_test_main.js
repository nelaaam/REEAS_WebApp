const child = require('child_process');
const getInformation = './getInformation_test';
const calculator = require('../scripts/calculator').getDisplacementFromVelocity;

//arrange data according to arrival time
let station1_data_z = [-348 ,	-332 ,	-351 ,	-374 ,	-401 ,	-481 ,	-513 ,	-558 ,	-630 ,	-702 ,	-773 ,	-795 ,	-865 ,	-942 ,	-972 ,	-1009 ,	-1037 ,	-1052 ,	-1024 ,	-989 ,	-905 ,	-681 ,	-442 ,	-211 ,	44 ,	433 ,	1359 ,	2973 ,	5644 ,	10143 ,	17186 ,	27640 ,	41415 ,	57590 ,	75216 ,	92865 ,	109505 ,	125625 ,	141645 ,	156718 ,	170677 ,	183973 ,	196049 ,	206628 ,	215203 ,	218714 ,	217833 ,	218127 ,	220197 ,	219278 ]; //array of data va
let station1_data_y = [188092 ,	263389 ,	196690 ,	137489 ,	134502 ,	176184 ,	283407 ,	310771 ,	273105 ,	207596 ,	9591 ,	-146308 ,	-214311 ,	-292267 ,	-343025 ,	-270065 ,	-53158 ,	135806 ,	139671 ,	-70720 ,	-273865 ,	-331448 ,	-309522 ,	-101495 ,	253043 ,	572950 ,	762724 ,	805737 ,	829912 ,	808105 ,	778884 ,	902067 ,	1172480 ,	1459266 ,	1520070 ,	1428209 ,	1308067 ,	1138757 ,	1020639 ,	951284 ,	850269 ,	658225 ,	317716 ,	-159623 ,	-500144 ,	-569967 ,	-489271 ,	-273656 ,	-87478 ,	751 ]; //array of data nsa
let station2_data_z = [9963 ,	9883 ,	9675 ,	9375 ,	9071 ,	8819 ,	8600 ,	8358 ,	8051 ,	7553 ,	7014 ,	6544 ,	6068 ,	5560 ,	4986 ,	4533 ,	4067 ,	3350 ,	2595 ,	1915 ,	1338 ,	840 ,	295 ,	-218 ,	-816 ,	-1526 ,	-2215 ,	-2793 ,	-3220 ,	-3603 ,	-3932 ,	-4262 ,	-4611 ,	-4911 ,	-5191 ,	-5445 ,	-5470 ,	-5305 ,	-5069 ,	-4758 ,	-4460 ,	-4132 ,	-3523 ,	-2113 ,	781 ,	5766 ,	12612 ,	20360 ,	27861 ,	34133 ]; //array of data va
let station2_data_y = [49882 ,	54497 ,	58529 ,	62050 ,	66276 ,	70914 ,	74276 ,	76219 ,	76621 ,	75942 ,	73647 ,	69867 ,	65160 ,	60160 ,	57760 ,	58729 ,	63116 ,	69773 ,	75887 ,	80620 ,	83835 ,	86034 ,	88386 ,	90262 ,	89189 ,	84444 ,	77410 ,	70108 ,	64487 ,	61205 ,	59511 ,	57984 ,	55906 ,	52433 ,	47296 ,	42872 ,	41319 ,	43868 ,	50899 ,	59069 ,	65084 ,	67068 ,	63308 ,	55374 ,	45959 ,	37970 ,	34212 ,	35512 ,	40295 ,	46589 ]; //array of data nsa
let station3_data_z = [126 ,	-153 ,	355 ,	567 ,	557 ,	304 ,	693 ,	1452 ,	929 ,	1183 ,	2090 ,	2194 ,	1922 ,	2313 ,	2585 ,	2928 ,	3715 ,	3414 ,	3269 ,	4056 ,	4796 ,	5231 ,	5973 ,	6805 ,	7342 ,	8860 ,	10363 ,	11226 ,	12693 ,	14036 ,	15133 ,	15267 ,	15926 ,	18233 ,	19471 ,	21401 ,	22899 ,	22866 ,	23614 ,	24498 ,	25839 ,	27226 ,	28756 ,	28350 ,	26797 ,	27443 ,	27669 ,	28042 ,	29395 ,	30208 ]; //array of data va
let station3_data_y = [-42868 ,	-48796 ,	-51612 ,	-49461 ,	-45641 ,	-41431 ,	-42058 ,	-44511 ,	-41902 ,	-36229 ,	-30482 ,	-29167 ,	-27133 ,	-21847 ,	-18803 ,	-17351 ,	-20168 ,	-21054 ,	-14875 ,	-8494 ,	-5791 ,	-6540 ,	-10129 ,	-16362 ,	-22027 ,	-26390 ,	-29542 ,	-34873 ,	-39024 ,	-37582 ,	-36119 ,	-36016 ,	-39126 ,	-41302 ,	-40565 ,	-40541 ,	-39563 ,	-39130 ,	-38806 ,	-36275 ,	-32394 ,	-29665 ,	-30913 ,	-35233 ,	-37168 ,	-33501 ,	-28471 ,	-25449 ,	-23502 ,	-21927 ]; //array of data nsa
var pgd = [];
let raw_data = [station1_data_z, station2_data_z, station3_data_z,station1_data_y, station2_data_y, station3_data_y];
for (var i = 0; i < 6; i++) {
    pgd[i] = calculator(raw_data[i]);
}

let p_at = ["2019-04-11T08:18:47.019538Z", "2019-04-11T08:19:42.019538Z", "2019-04-11T08:19:56.000000Z"]; //array $
let s_at = ["2019-04-11T08:19:08.019538Z", "2019-04-11T08:20:47.019538Z", "2019-04-11T08:21:11.000000Z"]; //array $
let station_latitude = [42.02,36.55,46.96]; //array of lat
let station_longitude = [143.16,138.20,142.76]; //array of long

let promise = [p_at, s_at, pgd, station_latitude, station_longitude];
let information = child.fork(getInformation);
information.send(promise);
information.on('message', (earthquake_information) => {
    console.log("Test Results:")
    console.log(earthquake_information);
});
